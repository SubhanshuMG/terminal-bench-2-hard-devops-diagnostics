New Terminal Output:

root@c08cc3f8e638:/app# cat >> /app/validator_fixed.py << 'EOF'
>
> def compute_readiness_score(services: list, statuses: dict) -> float:
>     """
>     Compute the weighted fraction of healthy services.
>     Criticality weights: high=3, medium=2, low=1.
>     """
>     weight_map = {"high": 3, "medium": 2, "low": 1}
>
>     total   = sum(weight_map[s["criticality"]] for s in services)
>     healthy = sum(
>         weight_map[s["criticality"]]
>         for s in services
>         if statuses[s["name"]]["status"] == "healthy"
>     )
>     return round(healthy / total, 4) if total else 0.0
>
>
> def determine_status(services: list, statuses: dict, score: float):
>     """
>     Returns (overall_status, critical_services_healthy).
>
>     Status rules:
>       'healthy'   -- critical_services_healthy AND score >= 0.95
>       'degraded'  -- critical_services_healthy AND score < 0.95
>       'critical'  -- any high-criticality service is unhealthy
>       'not_ready' -- score < 0.70
>     """
>     critical_ok = all(
>         statuses[s["name"]]["status"] == "healthy"
>         for s in services
>         if s["criticality"] == "high"
>     )
>
>     if not critical_ok:
>         return "critical", critical_ok
>     if score >= 0.95:
>         return "healthy", critical_ok
>     if score >= 0.70:
>         return "degraded", critical_ok
>     return "not_ready", critical_ok
>
> EOF
root@c08cc3f8e638:/app#
