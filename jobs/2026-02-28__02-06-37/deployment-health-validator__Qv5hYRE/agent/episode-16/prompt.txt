New Terminal Output:

root@cc33336dcd28:/app# cat >> /app/validator.py << 'EOF'
>
> # ── 2. Health check ───────────────────────────────────────────────────────────
>
> def check_health(service: dict) -> dict:
>     """Probe a single service and return its health record."""
>     url = f"http://127.0.0.1:{service['port']}{service['health_endpoint']}"
>     try:
>         resp = requests.get(url, timeout=5)
>         healthy = resp.status_code == 200
>
>         # For JSON responses, check the status field
>         if healthy and resp.headers.get('content-type', '').startswith('application/json'):
>             try:
>                 data = resp.json()
>                 if 'status' in data:
>                     # Accepted operational values: 'ok', 'up', 'healthy'
>                     status_value = data['status'].lower()
>                     healthy = status_value in ['ok', 'up', 'healthy']
>             except (json.JSONDecodeError, AttributeError):
>                 pass  # If JSON parsing fails, fall back to HTTP status
>
>         return {
>             "status": "healthy" if healthy else "unhealthy",
>             "http_status": resp.status_code,
>             "criticality": service["criticality"],
>         }
>     except requests.exceptions.RequestException:
>         return {
>             "status": "unhealthy",
>             "http_status": 0,
>             "criticality": service["criticality"],
>         }
>
> EOF
root@cc33336dcd28:/app#
